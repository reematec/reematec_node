(()=>{let e={ESCAPE:27,TAB:9};function t(e){document.body.classList.add("body-overflow"),y=document.activeElement,e.classList.toggle("show-modal"),e.addEventListener("keydown",n);let t=e.querySelectorAll("input:not([disabled]), button:not([disabled])");E=t[0],h=t[t.length-1],E&&E.focus()}function n(t){t.keyCode===e.TAB&&document.activeElement===h&&(t.preventDefault(),E.focus())}function o(e){e.classList.toggle("show-modal"),document.body.classList.remove("body-overflow"),y.focus()}window.addEventListener("click",(function(e){e.target===v?o(v):e.target===S?o(S):e.target===N?o(N):e.target===b&&o(b)})),document.addEventListener("keydown",(t=>{const n=document.querySelector(".show-modal");t.keyCode===e.ESCAPE&&n&&o(n)}));let r=document.querySelector("select#subCategory"),a=document.querySelector("select#category");a&&a.addEventListener("change",(function(e){let t=a.options[a.selectedIndex].value;const n=new XMLHttpRequest;return n.open("GET","getsubcategories/"+t+"/",!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=()=>{let e="";JSON.parse(n.responseText).subcategories.forEach((t=>{e+=`<option value="${t.id}">${t.name}</option>`})),r.innerHTML=e},n.send(),!1}));let c=document.querySelector(".navbar__brand__hamburger");c&&c.addEventListener("click",(function(){let e=document.getElementById("navbar-links");e&&e.classList.toggle("navbar__collapsed")}));let l=document.querySelector("#contact-list-slider");if(l){const F=l.previousElementSibling,G=l.nextElementSibling;let J=Array.from(l.children),U=l.parentElement.clientWidth,K=3e3;J.forEach((function(e,t){e.style.left=U*t+"px"})),l.addEventListener("mouseover",d),F.addEventListener("mouseover",d),G.addEventListener("mouseover",d),l.addEventListener("mouseleave",u),F.addEventListener("mouseleave",u),G.addEventListener("mouseleave",u),G.addEventListener("click",(function(){s>1&&(l.style.left=parseInt(l.style.left.replace("px",""))+U+"px",s--)})),F.addEventListener("click",(function(){s<l.childElementCount&&(l.style.left="-"+s*U+"px",s++)}));var s=1;function i(){l.style.left="-"+U*s+"px",++s>l.childElementCount&&(l.style.left="0px",s=1),F.style.display="block"}let z=setInterval(i,K);function d(){clearInterval(z)}function u(){z=setInterval(i,K)}}const m=document.querySelector("#wait-spinner"),p=document.querySelector("#messagebox");let g,v,f,y,E,h;document.querySelector("#modal-search")&&document.querySelector("#btnSearch")&&document.querySelector(".close-button")&&(v=document.querySelector("#modal-search"),g=document.querySelector("#btnSearch"),g.addEventListener("click",(function(){t(v)})),f=v.querySelector(".close-button"),f.addEventListener("click",(function(){o(v)})));const b=document.querySelector("#modal-image-preview");if(b){const V=document.querySelectorAll("[show-image-preview]");for(let Y=0;Y<V.length;Y++)V[Y].addEventListener("click",(e=>{t(b);const n=b.querySelector(".preview-wrapper");n.textContent="";const o=document.createElement("span");o.classList.add("loader"),n.append(o),n.textContent="";const r=document.createElement("img");r.classList.add("image-responsive"),r.id="imgPreview",r.src=`/images/assets/${V[Y].dataset.identifier}`,n.append(r)}));b.querySelector(".close-button").addEventListener("click",(function(){o(b)}))}const q=document.querySelectorAll("[smallThumbnail]");if(q.length>0)for(let Z=0;Z<q.length;Z++)q[Z].addEventListener("click",(e=>{const t=document.querySelector("#current-image");t&&(t.src=e.target.src.replace("/100","/500"),t.dataset.identifier=e.target.src.substring(e.target.src.lastIndexOf("/")+1))}));let L,S;const _=document.querySelector("[RFQ-BUTTON]");_&&_.addEventListener("click",(e=>{if(e.preventDefault(),S){t(S);let e=S.querySelector("#rfq-preview");e.querySelector(".image-responsive").src=document.querySelector("#current-image").src,e.querySelector("#prod-name").innerText=document.querySelector("#name-rfq").firstChild.textContent,document.querySelector("#prodIdentifier").value=document.querySelector("[productIdentifier]").textContent,w()}})),L=document.querySelectorAll("[quoteWrapper]"),S=document.querySelector("#modal-quote");for(let ee=0;ee<L.length;ee++)L[ee].addEventListener("click",x);function x(e){if(e.target.hasAttribute("quoteButton")&&(e.preventDefault(),S)){t(S);let n=S.querySelector("#rfq-preview");const o=e.target.parentElement.parentElement.parentElement;n.querySelector(".image-responsive").src=o.querySelector("[productImage]").src,n.querySelector("#prod-name").textContent=o.querySelector(".card__caption__basic__name").textContent,document.querySelector("#prodIdentifier").value=o.querySelector("[productIdentifier]").textContent,w()}}function w(){const e=S.querySelector("#frmQuote");e.txtFullName.value=null,e.txtEmail.value=null,e.txtCountry.value=null,e.txtQuantity.value=null,e.addEventListener("submit",A)}function A(e){e.preventDefault(),e.stopImmediatePropagation(),grecaptcha.execute("6LefTBApAAAAAGdco4sK5twxnRng07x-QJLSaO8K",{action:"submit"}).then((async function(t){const n=JSON.stringify({fullname:e.target.txtFullName.value,email:e.target.txtEmail.value,country:e.target.txtCountry.value,quantity:e.target.txtQuantity.value,_csrfToken:e.target._csrfToken.value,identifier:e.target.prodIdentifier.value,captcha:t});m.classList.remove("display-none"),m.classList.add("flex");try{const t=await fetch("/rfq",{method:"POST",headers:{Accept:"application/json, text/plain, */*","content-type":"application/json"},body:n}),o=await t.json();o.success?(p.classList.remove("bg-red"),p.classList.add("bg-green"),p.firstElementChild.textContent=o.message,e.target.txtFullName.value=null,e.target.txtEmail.value=null,e.target.txtCountry.value=null,e.target.txtQuantity.value=null):(p.classList.add("bg-red"),p.classList.remove("bg-green"),p.firstElementChild.textContent=o.message)}catch(e){console.log("bad response",e),p.classList.add("bg-red"),p.classList.remove("bg-green"),p.firstElementChild.textContent="Email not sent, invalid request"}finally{console.log("finally"),m.classList.remove("flex"),m.classList.add("display-none"),p.classList.add("show-message"),o(S)}}))}if(S){const te=S.querySelectorAll("[close-button]");if(te.length>0)for(let ne=0;ne<te.length;ne++)te[ne].addEventListener("click",(()=>{o(S)}))}const C=window.location;let k=1;const $=document.querySelector("#product-container"),I=document.querySelector("#btnLoadMore");let T,R,N;I&&I.addEventListener("click",(e=>{e.preventDefault(),console.log(`${C.origin}${C.pathname}/${k}${C.search}`),fetch(`${C.origin}${C.pathname}/${k}${C.search}`).then((e=>e.json())).then((e=>{console.log(e);const t=e.data.rows;Number(e.currentPage)+1>=e.totalPages&&(I.style.visibility="hidden"),k++,t.forEach((e=>{const t=document.createElement("div");t.setAttribute("quoteWrapper",""),t.classList="product-page-collection__grid__card";const n=document.createElement("a");n.classList="btn card__wrapper",n.href=`/product/${e.slug}`,t.append(n),t.addEventListener("click",x);const o=document.createElement("img");o.setAttribute("productImage",""),o.classList="image-responsive",o.src=`/images/assets/300/${e.images[0].src}`,n.append(o);const r=document.createElement("div");r.classList="card__caption",n.append(r);const a=document.createElement("div");a.classList="card__caption__basic",r.append(a);const c=document.createElement("p");c.classList="card__caption__basic__name",c.append(e.name),a.append(c);const l=document.createElement("div");l.classList="card__caption__basic__info",a.append(l);const s=document.createElement("h3");l.append(s),s.append(e.usage);const i=document.createElement("p");l.append(i),e.subCategoryId&&i.append(e.subCategory.name);const d=document.createElement("div");d.classList="card__caption__attribute",r.append(d);const u=document.createElement("div");u.classList="card__caption__attribute__mod",d.append(u);const m=document.createElement("h4");u.append(m);const p=document.createElement("p");u.append(p);const g=document.createElement("span");u.append(g);const v=document.createElement("button");v.setAttribute("quoteButton",""),v.classList="quote-button",v.append("Get Quote"),d.append(v),$&&$.append(t)}))}))})),T=document.querySelector("#btn-model-images"),T&&T.addEventListener("click",j),R=document.querySelector("#load-more-images"),R&&R.addEventListener("click",j);let P=document.querySelector("#image-showcase"),O="/home/imagesAjax/?page=0";function j(e){e.preventDefault(),N=document.querySelector("#modal-images"),N&&"btn-model-images"==e.target.id&&t(N);const n=new XMLHttpRequest;return n.open("GET",O,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=()=>{const t=JSON.parse(n.responseText);if("btn-model-images"==e.target.id&&1==t.page)o();else{if("load-more-images"!=e.target.id)return;o()}function o(){R.disabled||t.images.forEach((e=>{const t=document.createElement("img");t.classList.add("product-image"),t.src=`/images/assets/100/${e.src}`,t.setAttribute("id",e.id),P.appendChild(t)}))}if(t.currentPage<t.totalPages){let e=Number(t.currentPage)+Number(1);O=`/home/imagesAjax/?page=${e}`}else R.disabled=!0,t.images=null},n.send(),!1}document.querySelector("#modal-images .close-button")&&document.querySelector("#modal-images .close-button").addEventListener("click",(function(e){o(N)}));const B=document.querySelector("#product-image-array"),D=document.querySelector("#selected-images");P&&P.addEventListener("click",(e=>{if("img"==e.target.localName){let t=null;if(B&&Array.from(B.children).forEach((n=>{n.value==e.target.id&&(n.remove(),t=!0,e.target.classList.remove("image-border-highlight"))})),D&&Array.from(D.children).forEach((n=>{n.id==e.target.id&&(n.remove(),t=!0)})),!t){const t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","image"),t.setAttribute("value",e.target.id),B.appendChild(t);const n=document.createElement("span");n.setAttribute("id",e.target.id);const o=document.createElement("input");o.setAttribute("type","button"),o.setAttribute("id",e.target.id),o.setAttribute("value","x"),o.classList.add("remove-button");let r=document.createElement("img");r.src=e.target.src,n.appendChild(o),n.appendChild(r),D.appendChild(n),e.target.classList.add("image-border-highlight")}}})),D&&D.addEventListener("click",(e=>{e.target.classList.contains("remove-button")&&(e.target.parentElement.remove(),B&&Array.from(B.children).forEach((t=>{t.value==e.target.id&&t.remove()})))}));const H=document.querySelector("#frmCollection"),Q=document.querySelector("#sorting");Q&&(Q.onchange=function(e){return H&&H.collection.value?window.location.href=`${document.location.pathname}?sort=${e.target.value}&collection=${H.collection.value}`:window.location.href=`${document.location.pathname}?sort=${e.target.value}`});const M=document.querySelector(".btnReset");M&&M.addEventListener("click",(e=>{e.preventDefault(),window.location.href=document.location.pathname}));const X=document.querySelector("#image-preview-wrapper"),W=document.querySelector("#upload-image");X&&W.addEventListener("change",(function(e){if(e.target.files.length>0)for(let t=0;t<e.target.files.length;t++){const n=URL.createObjectURL(e.target.files[t]),o=document.createElement("img");o.src=n,o.width=100,X.appendChild(o)}}))})();